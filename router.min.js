'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}window.STRouter=function(){var a=function(){function b(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;_classCallCheck(this,b),this.routes=c,this.defaulRoute=this.getDefaulRoute,this.links=[],this.componentNames=new Set,this.__setGlobalAliases(),this.detectMountPlace(),this._clickWatching(),this._popWatching(),this.render()}return _createClass(b,[{key:'__setGlobalAliases',value:function __setGlobalAliases(){window.$routes=this.routes}},{key:'getComponents',value:function getComponents(){var d=this;if(this.routes){var c=this.routes.find(function(g){return g.path==d.getLocation.path});return c?c:this.defaulRoute}var f=new Error('STR-Warn: \u041D\u0435 \u0437\u0430\u0434\u0430\u043D\u044B \u043C\u0430\u0440\u0448\u0440\u0443\u0442\u044B. Routes are not defined.');console.warn(f.message)}},{key:'detectMountPlace',value:function detectMountPlace(){if(0==document.getElementsByTagName('router-view').length){var c=new Error('STR-Warn: \u041D\u0435 \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u044B \u0442\u043E\u0447\u043A\u0438 \u043C\u043E\u043D\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F. Missing "<router-view>" tag.');console.warn(c.message)}}},{key:'_setMountPlace',value:function _setMountPlace(){for(var c=document.getElementsByTagName('router-view'),d=0;d<c.length;d++){this.componentNames.add(c[d].getAttribute('name'));var f=document.createElement('div');f.setAttribute('name','component-'+c[d].getAttribute('name')),c[d].insertAdjacentElement('beforebegin',f)}var g=function(){for(var h=0;h<document.getElementsByTagName('router-view').length;h++)document.getElementsByTagName('router-view')[h].remove();0<document.getElementsByTagName('router-view').length&&g()};g()}},{key:'_clearMountPlace',value:function _clearMountPlace(){this.componentNames.forEach(function(c){document.getElementsByName('component-'+c).forEach(function(d){return d.innerHTML=''})})}},{key:'_comparing',value:function _comparing(c){return /^[^\s]+[a-z0-9а-яё]+?<.+?>/i.test(c)||/<\/.+>[a-z0-9а-яё]+?[^\s]+/i.test(c)}},{key:'_setVirtualDom',value:function _setVirtualDom(c){var h=this;if(0<c.childElementCount){c.children.forEach=[].forEach;var d=[],f='',g='';return c.children.forEach(function(j){g=j.tagName.toString().toLowerCase(),d.push({attributes:0==j.attributes.length?[]:function(){var k=[];return j.getAttributeNames().forEach(function(l){k.push(_defineProperty({},l,'hidden'==l||j.getAttribute(l))),'router-view'==g&&(f=j.getAttribute(l))}),k}(),tag:g,component:'router-view'==g?f:'',content:h._comparing(j.innerHTML)?j.innerHTML:'',children:0==j.childElementCount||'router-view'==g||h._comparing(j.innerHTML)?[]:function(){return h._setVirtualDom(j)}()})}),d}return[]}},{key:'_runMethods',value:function _runMethods(c){for(var j,d=/[^{]+(?=}})/ig,f=c.template,g=c.methods,h=[];null!==(j=d.exec(f));)h=h.concat(j);return null!==h&&h.forEach(function(k){g&&g[k]&&(f=f.replace(RegExp('{{'+k+'}}'),g[k]()))}),f}},{key:'render',value:function render(){var d=this;if(this._setMountPlace(),!!this.getComponents()){this._clearMountPlace();var c=this.getComponents();this.componentNames.forEach(function(f){if(c.components.hasOwnProperty(f)){var g=function(){switch(_typeof(c.components[f])){case'function':return c.components[f]();case'object':return c.components[f];}}(),h=d._runMethods(g);document.getElementsByName('component-'+f).forEach(function(j){return j.insertAdjacentHTML('beforeend',h)})}})}}},{key:'_pushLinkToHistory',value:function _pushLinkToHistory(c,d){this.links.push(d),history.pushState(c,'',d)}},{key:'_popWatching',value:function _popWatching(){var c=this;window.onpopstate=function(){c.render()}}},{key:'_clickWatching',value:function _clickWatching(){var d=this;document.addEventListener('click',function c(f){'A'==f.target.tagName&&(f.preventDefault(),d._pushLinkToHistory('',f.target.toString()),d.render())})}},{key:'version',get:function get(){return'0.3.0-beta'}},{key:'getLocation',get:function get(){return{hash:location.hash,href:location.href,origin:location.origin,path:location.pathname,search:location.search}}},{key:'getDefaulRoute',get:function get(){var c;if(this.routes&&(c=this.routes.find(function(f){return'*'==f.path})),!c){var d=new Error('STR-Warn: \u041D\u0435 \u0437\u0430\u0434\u0430\u043D \u043C\u0430\u0440\u0448\u0440\u0443\u0442 \u043F\u043E-\u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E. Default route is not defined.');console.warn(d.message)}return c}}]),b}();return a}();